{% block summernote_javascript %}
    {% spaceless %}
        <script src="{{ asset('resources/summernote/summernote.min.js') }}"></script>
        <script type="text/javascript">
            $(function () {
                $('.summernote').summernote({
                    width: {{ pepsit36_summernote_config_width ?: 'null' }},
                    height: {{ pepsit36_summernote_config_height ?: 'null' }},
                    focus: {{ pepsit36_summernote_config_focus ? 'true' : 'false' }},
                    toolbar: {{ pepsit36_summernote_config_toolbar | raw }},
                    styleTags: {{ pepsit36_summernote_config_styleTags | raw }},
                    fontNames: {{ pepsit36_summernote_config_fontNames | raw }},
                    fontSizes: {{ pepsit36_summernote_config_fontSizes | raw }},
                    colors: {{ pepsit36_summernote_config_colors | raw }},
                    callbacks: {
                        onImageUpload: function (files) {
                            sendFile(files[0], $(this));
                        }
                    }
                });
            });

            function sendFile(file, editor) {
                var data = new FormData();
                data.append("summernote_image", file);
                $.ajax({
                    data: data,
                    type: "POST",
                    url: '{{ path('pepsit36_summernote.api.upload') }}',
                    cache: false,
                    processData: false,
                    contentType: false,
                    success: function (returnData) {
                        if (returnData.success) {
                            editor.summernote('insertImage', returnData.url);
                        } else {
                            alert(returnData.message);
                        }
                    }
                });
            }
        </script>
    {% endspaceless %}
{% endblock %}
